<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Soneium Tx Tool v2</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #0f172a; color: white; display: flex; justify-content: center; padding-top: 50px; }
        .card { background: #1e293b; padding: 30px; border-radius: 20px; width: 380px; border: 1px solid #334155; text-align: center; }
        .btn { width: 100%; padding: 15px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; margin-top: 15px; transition: 0.3s; }
        .btn-connect { background: #38bdf8; color: #0f172a; }
        .btn-start { background: #22c55e; color: white; display: none; }
        .btn-stop { background: #ef4444; color: white; display: none; }
        .stat { background: #334155; padding: 15px; border-radius: 12px; margin: 20px 0; font-family: monospace; font-size: 0.85rem; }
        #counter { font-size: 2rem; color: #38bdf8; display: block; margin-top: 10px; }
    </style>
</head>
<body>

<div class="card">
    <h2 style="margin:0">Soneium Spammer</h2>
    <p style="color:#94a3b8; font-size: 0.8rem;">Ready for Zerion / MetaMask / Rabby</p>

    <div class="stat">
        Wallet: <span id="addr">Not Connected</span><br>
        <span id="counter">0</span>
        <small>Successful Transactions</small>
    </div>

    <button id="connectBtn" class="btn btn-connect" onclick="initWallet()">Connect Wallet</button>
    <button id="startBtn" class="btn btn-start" onclick="runSpam()">Start Popups (2s)</button>
    <button id="stopBtn" class="btn btn-stop" onclick="stopSpam()">Stop</button>
    
    <p id="msg" style="font-size: 0.7rem; color: #f87171; margin-top: 15px;"></p>
</div>

<script>
    let provider, signer, contract, interval;
    let count = 0;

    // --- PASTE YOUR CONTRACT ADDRESS HERE ---
    const contractAddress = "0xac3fa700149513bed425398f10a08767Aef138c3";
    const abi = ["function poke() public"];

    async function initWallet() {
        const message = document.getElementById("msg");
        // Force look for ANY provider (window.ethereum is the standard)
        const injected = window.ethereum || (window.zerion ? window.zerion.ethereum : null);

        if (!injected) {
            message.innerText = "Error: Wallet not found. Please refresh page (F5) or ensure your wallet is unlocked.";
            return;
        }

        try {
            provider = new ethers.providers.Web3Provider(injected);
            const accounts = await provider.send("eth_requestAccounts", []);
            signer = provider.getSigner();
            contract = new ethers.Contract(contractAddress, abi, signer);

            document.getElementById("addr").innerText = accounts[0].slice(0,6) + "..." + accounts[0].slice(-4);
            document.getElementById("connectBtn").style.display = "none";
            document.getElementById("startBtn").style.display = "block";
            message.innerText = "Wallet Connected!";
            message.style.color = "#22c55e";
        } catch (e) {
            message.innerText = "User denied connection.";
        }
    }

    function runSpam() {
        document.getElementById("startBtn").style.display = "none";
        document.getElementById("stopBtn").style.display = "block";
        
        interval = setInterval(async () => {
            try {
                // This triggers the Zerion/MetaMask popup
                const tx = await contract.poke();
                count++;
                document.getElementById("counter").innerText = count;
                // Wait for one tx to finish before next popup? 
                // Remove 'await' if you want them to stack up (dangerous!)
                await tx.wait(); 
            } catch (err) {
                console.log("Tx Cancelled");
            }
        }, 2000);
    }

    function stopSpam() {
        clearInterval(interval);
        document.getElementById("stopBtn").style.display = "none";
        document.getElementById("startBtn").style.display = "block";
    }
</script>
</body>
</html>