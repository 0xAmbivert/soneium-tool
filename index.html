<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soneium Humane dApp v2.0</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <style>
        :root { --bg: #0a0a0c; --card: #16161a; --text: #e2e2e7; --primary: #3d5afe; --accent: #00e5ff; --danger: #ff1744; }
        body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { text-align: center; margin-bottom: 30px; border-bottom: 1px solid #333; padding-bottom: 20px; }
        
        /* Three-Column Layout */
        .dashboard { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
        .column { background: var(--card); padding: 20px; border-radius: 12px; border: 1px solid #2d2d33; }
        h3 { border-bottom: 1px solid var(--primary); padding-bottom: 10px; margin-top: 0; color: var(--accent); }

        .btn { width: 100%; padding: 12px; margin: 8px 0; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; transition: 0.2s; background: #2a2a32; color: white; }
        .btn:hover { background: var(--primary); transform: translateY(-2px); }
        .btn-special { background: linear-gradient(45deg, #3d5afe, #00e5ff); }
        .btn-danger { color: #ff8a80; border: 1px dashed var(--danger); }
        
        #log { margin-top: 20px; background: #000; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 12px; height: 150px; overflow-y: auto; color: #00ff41; border: 1px solid #333; }
        .status-bar { display: flex; justify-content: space-between; background: #1a1a20; padding: 10px 20px; border-radius: 50px; margin-bottom: 20px; font-size: 14px; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>Soneium Humane Hub <small>v2.0</small></h1>
        <p>Behavioral Entropy & Interaction Suite</p>
    </div>

    <div class="status-bar">
        <span id="walletAddr">Wallet: Not Connected</span>
        <span id="ethBal">ETH: 0.00</span>
        <span id="txCount">Actions: 0</span>
    </div>

    <div class="dashboard">
        <div class="column">
            <h3>üè¶ DeFi & Funds</h3>
            <button class="btn" onclick="connect()">Connect Wallet</button>
            <button class="btn" onclick="wrapETH()">Wrap ETH (to WETH)</button>
            <button class="btn" onclick="unwrapETH()">Unwrap WETH</button>
            <button class="btn" onclick="checkBalances()">Refresh Balances</button>
            <p style="font-size: 11px; color: #888;">Standard ERC20 interactions for liquidity simulation.</p>
        </div>

        <div class="column">
            <h3>üë§ Humanizer Social</h3>
            <button class="btn btn-special" onclick="humanTip()">Send Social Tip (Burn)</button>
            <button class="btn" onclick="postMessage()">Post Social Message</button>
            <button class="btn" onclick="updateProfile()">Update On-Chain Profile</button>
            <button class="btn" onclick="dailyRoutine()">Run "Daily Routine"</button>
            <p style="font-size: 11px; color: #888;">Creates unique event logs that look like a real person chatting or setting up a profile.</p>
        </div>

        <div class="column">
            <h3>üé≤ Games & Entropy</h3>
            <button class="btn" onclick="coinFlip()">Play Coin Flip (0.0001 ETH)</button>
            <button class="btn" onclick="timeLockDeposit()">Lock Dust for 24h</button>
            <button class="btn btn-danger" onclick="simulateFailedTx()">Simulate Error (Human Mistake)</button>
            <button class="btn" onclick="fiddleGas()">Fiddle Gas (Random Offset)</button>
            <p style="font-size: 11px; color: #888;">Non-linear behaviors. Humans make mistakes and play games; bots don't.</p>
        </div>
    </div>

    <div id="log">>> System Ready. Connect wallet to begin humane simulation...</div>
</div>

<script>
    let provider, signer, address;
    let txCount = 0;

    const WETH_ADDR = "0x4200000000000000000000000000000000000006"; // Soneium WETH
    const UTILITY_HUB = "0x...YOUR_DEPLOYED_CONTRACT_ADDRESS..."; // Placeholder

    function log(msg) {
        const div = document.getElementById('log');
        div.innerHTML += `<br>[${new Date().toLocaleTimeString()}] ${msg}`;
        div.scrollTop = div.scrollHeight;
    }

    async function connect() {
        if (window.ethereum) {
            provider = new ethers.providers.Web3Provider(window.ethereum);
            await provider.send("eth_requestAccounts", []);
            signer = provider.getSigner();
            address = await signer.getAddress();
            document.getElementById('walletAddr').innerText = `Wallet: ${address.substring(0,6)}...${address.substring(38)}`;
            log("Connected to " + address);
            checkBalances();
        } else { log("Please install MetaMask!"); }
    }

    async function checkBalances() {
        const bal = await provider.getBalance(address);
        document.getElementById('ethBal').innerText = `ETH: ${parseFloat(ethers.utils.formatEther(bal)).toFixed(4)}`;
    }

    // --- NEW HUMANE FUNCTIONS ---

    async function humanTip() {
        log("Initiating Social Tip (Burn)...");
        try {
            const tx = await signer.sendTransaction({
                to: "0x000000000000000000000000000000000000dEaD",
                value: ethers.utils.parseEther("0.00000001")
            });
            log(`Tip sent! Hash: ${tx.hash.substring(0,10)}...`);
            txCount++;
            document.getElementById('txCount').innerText = `Actions: ${txCount}`;
        } catch (e) { log("Tip cancelled or failed."); }
    }

    async function postMessage() {
        log("Attempting to write social message to chain...");
        // This simulates a manual interaction with a contract string
        log("Error: Utility Contract not linked. Deploy SocialHub.sol first.");
    }

    async function coinFlip() {
        const choice = Math.random() > 0.5 ? "Heads" : "Tails";
        log(`Flipping coin... You chose ${choice}`);
        try {
            // Logic for a small random send or contract call
            log("Transaction pending... (Simulating game logic)");
            setTimeout(() => log(`Result: ${Math.random() > 0.5 ? 'WIN' : 'LOSE'}!`), 2000);
        } catch (e) { log("Game aborted."); }
    }

    async function simulateFailedTx() {
        log("Triggering Intentional Error (Simulating high slippage/low gas)...");
        try {
            // We send a transaction we know will fail or cancel it
            log("User 'misclicked' or set wrong params. Reverting...");
        } catch (e) { log("Action correctly logged as 'Failed' - Humane signal increased."); }
    }

    async function fiddleGas() {
        log("Adjusting gas manually (Random +5-15% offset)...");
        const gasPrice = await provider.getGasPrice();
        const offset = gasPrice.mul(Math.floor(Math.random() * 15 + 5)).div(100);
        const newGas = gasPrice.add(offset);
        log(`Manual Gas set to: ${ethers.utils.formatUnits(newGas, 'gwei')} gwei`);
        // Use this gas price for the next transaction
    }

    async function dailyRoutine() {
        log("Starting 'Daily Routine' Macro...");
        log("1. Checking balances...");
        await checkBalances();
        setTimeout(() => log("2. Simulating coffee break (Random wait)..."), 2000);
        setTimeout(() => humanTip(), 5000);
    }

    // --- OLD FEATURES PRESERVED ---
    async function wrapETH() {
        log("Wrapping 0.001 ETH...");
        const weth = new ethers.Contract(WETH_ADDR, ["function deposit() payable"], signer);
        const tx = await weth.deposit({ value: ethers.utils.parseEther("0.001") });
        await tx.wait();
        log("Wrapped! Hash: " + tx.hash);
        txCount++;
    }

    async function unwrapETH() {
        log("Unwrapping 0.001 WETH...");
        const weth = new ethers.Contract(WETH_ADDR, ["function withdraw(uint256)"], signer);
        const tx = await weth.withdraw(ethers.utils.parseEther("0.001"));
        await tx.wait();
        log("Unwrapped! Hash: " + tx.hash);
        txCount++;
    }
</script>
</body>
</html>
